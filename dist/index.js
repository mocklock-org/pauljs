"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault"),_defineProperty2=_interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach((function(r){(0,_defineProperty2.default)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}const fs=require("fs").promises,path=require("path"),ejs=require("ejs"),express=require("express"),PaulJSCore=require("./core");class PaulJS{constructor(){this.app=express(),this.pages=new Map,this.core=new PaulJSCore,this.setupMiddleware(),this.initializeCore()}async initializeCore(){try{this.core.loadBuiltInComponents()}catch(e){throw new Error(`Failed to initialize PaulJS: ${e.message}`)}}setupMiddleware(){this.app.use(express.static("public")),this.app.use("/styles",express.static(path.join(process.cwd(),"styles"))),this.app.use(express.json()),this.app.set("view engine","ejs"),this.app.set("views",path.join(__dirname,"templates"))}async createPage(e,r={}){try{const t={title:"PaulJS Page",description:"Built with PaulJS",styles:"",scripts:"",hero:{},cta:{},footer:{}};this.clearComponentCache();const o=_objectSpread(_objectSpread(_objectSpread({},t),r),{},{hero:this.core.getComponent("hero").render(r.hero||{}),cta:this.core.getComponent("cta").render(r.cta||{}),footer:this.core.getComponent("footer").render(r.footer||{})});return this.pages.set(e,o),this.app.get(e,((e,t)=>{const s=_objectSpread(_objectSpread({},o),{},{hero:this.core.getComponent("hero").render(r.hero||{}),cta:this.core.getComponent("cta").render(r.cta||{}),footer:this.core.getComponent("footer").render(r.footer||{})});t.render("default",s)})),e}catch(r){throw new Error(`Failed to create page ${e}: ${r.message}`)}}async exportStaticSite(e="dist"){try{await fs.mkdir(e,{recursive:!0});for(const[r,t]of this.pages){const o=path.join(__dirname,"templates","default.ejs"),s=await fs.readFile(o,"utf-8"),n=ejs.render(s,t),i=path.join(process.cwd(),e,"/"===r?"index.html":`${r.slice(1)}.html`);await fs.writeFile(i,n)}return e}catch(e){throw new Error(`Error exporting static site: ${e.message}`)}}start(e=3e3){return new Promise(((r,t)=>{try{this.server=this.app.listen(e,(()=>{r(this.server)}))}catch(e){t(new Error(`Failed to start server: ${e.message}`))}}))}stop(){this.server&&this.server.close()}registerComponent(e,r){this.core.registerComponent(e,r)}clearComponentCache(){this.core.clearCache()}}const componentFactory=(e,r)=>(t={})=>{try{return r.getComponent(e.name).render(t)}catch(e){throw new Error(`Component render failed: ${e.message}`)}},core=new PaulJSCore;core.loadBuiltInComponents(),module.exports={createApp:()=>new PaulJS,components:Array.from(core.components.entries()).reduce(((e,[r,t])=>(e[r]=componentFactory(t,core),e)),{}),adapters:{react:require("./adapters/react")}};
//# sourceMappingURL=index.js.map
//# sourceMappingURL=sourcemaps\index.js.map