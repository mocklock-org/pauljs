"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault"),_defineProperty2=_interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach((function(t){(0,_defineProperty2.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const fs=require("fs").promises,path=require("path"),ejs=require("ejs"),express=require("express"),PaulJSCore=require("./core");class PaulJS{constructor(){this.app=express(),this.pages=new Map,this.core=new PaulJSCore,this.setupMiddleware(),this.initializeCore()}async initializeCore(){try{this.core.loadBuiltInComponents()}catch(e){throw new Error(`Failed to initialize PaulJS: ${e.message}`)}}setupMiddleware(){this.app.use(express.static("public")),this.app.use("/styles",express.static(path.join(process.cwd(),"styles"))),this.app.use(express.json()),this.app.set("view engine","ejs"),this.app.set("views",path.join(__dirname,"templates"))}async createPage(e,t={}){try{const r={title:"PaulJS Page",description:"Built with PaulJS",styles:"",scripts:"",hero:{},cta:{},footer:{}};this.clearComponentCache();const o=_objectSpread(_objectSpread(_objectSpread({},r),t),{},{hero:null!==t.hero&&""!==t.hero?this.core.getComponent("hero").render(t.hero||{}):"",cta:null!==t.cta&&""!==t.cta?this.core.getComponent("cta").render(t.cta||{}):"",footer:null!==t.footer&&""!==t.footer?this.core.getComponent("footer").render(t.footer||{}):""});return this.pages.set(e,o),this.app.get(e,((e,r)=>{const s=_objectSpread(_objectSpread({},o),{},{hero:null!==t.hero&&""!==t.hero?this.core.getComponent("hero").render(t.hero||{}):"",cta:null!==t.cta&&""!==t.cta?this.core.getComponent("cta").render(t.cta||{}):"",footer:null!==t.footer&&""!==t.footer?this.core.getComponent("footer").render(t.footer||{}):""});r.render("default",s)})),e}catch(t){throw new Error(`Failed to create page ${e}: ${t.message}`)}}async exportStaticSite(e="dist"){try{await fs.mkdir(e,{recursive:!0});for(const[t,r]of this.pages){const o=path.join(__dirname,"templates","default.ejs"),s=await fs.readFile(o,"utf-8"),n=ejs.render(s,r),a=path.join(process.cwd(),e,"/"===t?"index.html":`${t.slice(1)}.html`);await fs.writeFile(a,n)}return e}catch(e){throw new Error(`Error exporting static site: ${e.message}`)}}start(e=3e3){return new Promise(((t,r)=>{try{this.server=this.app.listen(e,(()=>{t(this.server)}))}catch(e){r(new Error(`Failed to start server: ${e.message}`))}}))}stop(){this.server&&this.server.close()}registerComponent(e,t){this.core.registerComponent(e,t)}clearComponentCache(){this.core.clearCache()}getComponents(){return this.core.components}}const componentFactory=(e,t,r)=>(r={})=>{try{if(null===r||""===r)return"";const e=_objectSpread(_objectSpread({},t.defaultProps||{}),r);return t.render(e)}catch(t){throw new Error(`Component ${e} render failed: ${t.message}`)}},pauljs=new PaulJS;module.exports={createApp:()=>pauljs,components:Array.from(pauljs.getComponents().entries()).reduce(((e,[t,r])=>(e[t]=componentFactory(t,r,pauljs.core),e)),{}),adapters:{react:require("./adapters/react")}};
//# sourceMappingURL=index.js.map
//# sourceMappingURL=sourcemaps\index.js.map